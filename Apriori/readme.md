# 使用Apriori算法进行关联分析

关联分析是一种在大规模数据集中寻找有趣关系的任务。这些关系可以有两种形式：频繁项集或者关联规则。频繁项集（frequent item sets）是经常出现在一块的物品的集合，关联规则（association rules）暗示两种物品之间可能存在很强的关系。

## 使用Apriori 算法来发现频繁集
Apriori算法是发现频繁项集的一种方法。Apriori算法的两个输入参数分别是最小支持度和数据集。该算法首先会生成所有单个物品的项集列表。接着扫描交易记录来查看哪些项集满足最小支持度要求，那些不满足最小支持度的集合会被去掉。然后，对剩下来的集合进行组合以生成包含两个元素的项集。接下来，再重新扫描交易记录，去掉不满足最小支持度的项集。该过程重复进行直到所有项集都被去掉。

## 数据集扫描
在使用Python来对整个程序编码之前，需要创建一些辅助函数。下面会创建一个用于构建初始集合的函数，也会创建一个通过扫描数据集以寻找交易记录子集的函数。数据集扫描的伪代码大致如下：
对数据集中的每条交易记录tran
对每个候选项集can：
	检查一下can是否是tran的子集：
	如果是，则增加can的计数值
对每个候选项集：
	如果其支持度不低于最小值，则保留该项集
返回所有频繁项集列表

## 组织完整的Apriori 算法
整个Apriori算法的伪代码如下：
当集合中项的个数大于0时
	构建一个k个项组成的候选项集的列表
	检查数据以确认每个项集都是频繁的
	保留频繁项集并构建k+1项组成的候选项集的列表

Ck, Lk之间的关系如下
                 空集
            0   1   2   3                           Ck代表k行的所有元素, Lk代表k行支持度不小于最小支持度的元素（即频繁项集）
        01  02  03  12  13  23                      C(k+1)是由Lk随机组合成的组合，非频繁项集的超集肯定是非频繁项集
           012 013 023 123
                0123

## 从频繁项集中挖掘关联规则
频繁项集的量化定义，即它满足最小支持度要求。对于关联规则，我们也有类似的量化方法，这种量化指标称为可信度。一条规则P ? H的可信度定义为support(P |H)/support(P)。记住，在Python中，操作符|表示集合的并操作，而数学上集合并的符号是。P | H是指所有出现在集合P或者集合H中的元素。前面一节已经计算了所有频繁项集支持度。现在想获得可信度，所需要做的只是取出那些支持度值做一次除法运算。

对于0123集合的关联规则生成的过程应该如下图，从顶部向下:
                            0123->空集
                123->0  023->1  013->2  012->3
        23->01  13->02  12->03  03->12  02->13  01->23
                3->012  2->013  1->023  0->123
能够看出来H的生成过程同频繁项集Ck的生成过程是一样的，所以可以直接使用aprioriGen来生成H。
另外，可信度较低规则，所有以它的后件作为后件的规则的可信度都会较低，所以当一个规则的可信度小于最小可信度时，没有必要再继续计算以它后件为后件的规则的可信度。